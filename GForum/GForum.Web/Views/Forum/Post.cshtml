@using Microsoft.AspNet.Identity
@model GForum.Web.Models.Forum.PostViewModel
@{
    ViewBag.Title = "Post";
}

<div class="row">
    <div class="col-xs-10">
        <div class="card">
            @Html.Partial("_VotesPartial", Model)
            <div style="margin-left:40px">
                <h2 class="title">@Model.Title</h2>
                <p class="text-muted">
                    Submitted by
                    @Html.ActionLink(Model.Author.UserName, "Index", "Users", new { username = Model.Author.UserName }, null)
                    @Model.CreatedOn.Humanize(dateToCompareAgainst: DateTime.Now)
                    @if (Request.IsAuthenticated && User.Identity.GetUserId() == Model.Author.Id)
                    {
                        <span>&bull;</span>
                        <a class="edit-post-btn" href="#" data-edit-url="@Url.Action("Edit", new { postId = Model.Id })">Edit</a>
                    }
                    @if (Model.EditedOn != null)
                    {
                        <span>&bull;</span>
                        <text>Last edited</text>
                        @Model.EditedOn.Humanize(dateToCompareAgainst: DateTime.Now);
                    }
                </p>
                <div class="content" data-raw-content="@Model.Content">@Html.MarkdownToHtml(Model.Content)</div>
            </div>
        </div>
    </div>
    <div class="col-xs-2">
        @Html.ActionLink(
            "Submit a new post",
            "Submit",
            new { catgeoryId = Model.CategoryId },
            new { @class = "btn btn-primary" }
        )
    </div>
</div>

@section Scripts {
    <script src="~/Scripts/Site/votes-controller.js"></script>
    <script src="~/Scripts/Site/edit-controller.js"></script>
}
